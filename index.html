<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="public, max-age=86400">
    <meta http-equiv="Expires" content="86400">
    <title>西林磨损计算器</title>
    <link rel="icon" href="./favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="./favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div class="container">
        <div class="tab">
            <button class="tabButton active" onclick="TabManager.open('floatCombosDiv')">特殊磨损计算</button>
            <button class="tabButton" onclick="TabManager.open('wearCalculationDiv')">简易计算</button>
            <button class="tabButton" onclick="TabManager.open('autoCalculationDiv')">自动配材</button>
            <button class="tabButton" onclick="TabManager.open('ieee754Div')">查询</button>
            <button class="tabButton" onclick="TabManager.open('aboutAuthorDiv')">盘尼西林</button>
        </div>

        <div id="floatCombosDiv" class="tabcontent active">
            <h3 class="section-title">材料配置</h3>
            <div class="selector-group">
                <div class="selector-container">
                    <h4>选择合成材料数量</h4>
                    <select id="materialCountSelect" onchange="MaterialManager.updateCount()">
                        <option value="5" selected>5个材料</option>
                        <option value="10">10个材料</option>
                    </select>
                </div>
                <div class="selector-container">
                    <h4>选择材料种类数量</h4>
                    <select id="materialTypeCountSelect" onchange="MaterialManager.updateTypeCount()">
                        <option value="1" selected>1种材料</option>
                        <option value="2">2种材料</option>
                        <option value="3">3种材料</option>
                        <option value="4">4种材料</option>
                        <option value="5">5种材料</option>
                        <option value="6">6种材料</option>
                        <option value="7">7种材料</option>
                        <option value="8">8种材料</option>
                        <option value="9">9种材料</option>
                        <option value="10">10种材料</option>
                    </select>
                </div>
            </div>

            <div id="materialTypeContainers" class="material-types-container"></div>

            <div class="action-buttons">
                <button class="danger" onclick="MaterialManager.clearCurrentTab()">清空本页所有数据</button>
            </div>

            <h3 class="section-title">数据处理</h3>
            <textarea id="fcAltInput" onkeyup="CombinationCalculator.updatePreview()" rows="4"
                placeholder="在此输入总的材料数据，或使用上方的汇总功能..."></textarea>

            <h3 class="section-title">计算参数</h3>
            <div class="criteria-container">
                <div class="criteria-item">
                    <h4>目标产物最小磨损</h4>
                    <input id="fcCminwearinput" value="0.000000" placeholder="输入最小磨损">
                </div>
                <div class="criteria-item">
                    <h4>目标产物最大磨损</h4>
                    <input id="fcCmaxwearinput" placeholder="输入最大磨损">
                </div>
                <div class="criteria-item">
                    <h4>目标磨损值</h4>
                    <input id="fcCdesiredfloatinput" placeholder="输入目标磨损"
                        oninput="IEEE754.updateDisplay('fcCdesiredfloatinput', 'targetWearIEEEValue', 'targetWearIEEEDisplay')">
                    <div id="targetWearIEEEDisplay" class="ieee754-display">
                        IEEE754(实际磨损): <span id="targetWearIEEEValue" class="ieee754-value"></span>
                    </div>
                </div>
                <div class="criteria-item">
                    <h4>计算精确度</h4>
                    <input id="fcCspecificityinput" value="0.00000001" placeholder="输入精确度">
                </div>
            </div>

            <div class="action-buttons">
                <button class="primary" onclick="CombinationCalculator.start()">开始计算</button>
                <button class="danger" id="stopButton" onclick="CombinationCalculator.terminate()"
                    disabled>终止计算</button>
            </div>

            <div class="result-info" id="fcTotalCombosText">等待计算...</div>
            <div id="fcTheProgress">
                <div id="fcProgressBar"></div>
            </div>

            <h3 class="section-title">计算结果</h3>
            <div class="search-container">
                <div style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
                    <input type="text" id="searchInput" placeholder="在结果中搜索..." class="search-input">
                    <button onclick="SearchManager.perform()" class="primary">搜索</button>
                    <button onclick="SearchManager.prev()" class="secondary">上一个</button>
                    <button onclick="SearchManager.next()" class="secondary">下一个</button>
                    <span id="searchStatus" class="search-status">未搜索</span>
                </div>
            </div>
            <div class="info-box">
                <strong>注意：</strong> 1.请严格按照计算出来的顺序（从前往后）放入炉子。如果用BUFF或简易计算验证后发现数值不一样（往往是第七位以后不一样）请不要担心，按计算出来的顺序放不会错。2.计算10个材料建议放30个左右数据，计算5个材料建议放80个左右数据，请按照成品区间找大致材料区间（不明白可以去自动配材试），算不出结果就是材料太偏离目标了。
            </div>
            <div id="fcCombinationsText"></div>
        </div>

        <div id="wearCalculationDiv" class="tabcontent">
            <h3 class="section-title">简易磨损计算</h3>
            <div class="selector-group">
                <div class="selector-container">
                    <h4>选择材料数量</h4>
                    <select id="simpleMaterialCount" onchange="SimpleWearCalculator.updateTable()">
                        <option value="5" selected>5个材料</option>
                        <option value="10">10个材料</option>
                    </select>
                </div>
            </div>

            <h3 class="section-title">材料列表</h3>
            <div class="table-container">
                <table class="material-table">
                    <thead>
                        <tr>
                            <th>序号</th>
                            <th>磨损值</th>
                            <th>选择材料</th>
                            <th>磨损区间</th>
                        </tr>
                    </thead>
                    <tbody id="materialTableBody"></tbody>
                </table>
            </div>

            <div class="action-buttons">
                <button class="primary" onclick="SimpleWearCalculator.calculateWithProbability()">开始计算（含产物分析）</button>
                <button class="danger" onclick="SimpleWearCalculator.clear()">清空本页所有数据</button>
            </div>
            <div id="productProbabilityResults" class="results-container"></div>
        </div>

        <div id="autoCalculationDiv" class="tabcontent">
            <h3 class="section-title">自动配材</h3>
            <div class="selector-group">
                <div class="selector-container">
                    <h4>选择材料数量</h4>
                    <select id="autoMaterialCount" onchange="AutoMaterialCalculator.updateTable()">
                        <option value="5" selected>5个材料</option>
                        <option value="10">10个材料</option>
                    </select>
                </div>
                <div class="selector-container">
                    <h4>目标磨损等级</h4>
                    <select id="targetWearGrade" onchange="AutoMaterialCalculator.updateTargetRange()">
                        <option value="factory_new" selected>崭新出厂 (0-0.070000)</option>
                        <option value="minimal_wear">略有磨损 (0.070000-0.150000)</option>
                        <option value="field_tested">久经沙场 (0.150000-0.380000)</option>
                        <option value="well_worn">破损不堪 (0.380000-0.450000)</option>
                        <option value="battle_scarred">战痕累累 (0.450000-1.000000)</option>
                        <option value="custom">自定义</option>
                    </select>
                </div>
            </div>

            <h3 class="section-title">目标产物设置</h3>
            <div class="criteria-container">
                <div class="criteria-item">
                    <h4>目标产物最小磨损</h4>
                    <input type="text" id="autoTargetMin" placeholder="最小磨损"
                        oninput="InputValidator.number(this); AutoMaterialCalculator.recalculate();">
                </div>
                <div class="criteria-item">
                    <h4>目标产物最大磨损</h4>
                    <input type="text" id="autoTargetMax" placeholder="最大磨损"
                        oninput="InputValidator.number(this); AutoMaterialCalculator.recalculate();">
                </div>
                <div class="criteria-item">
                    <h4>目标磨损值</h4>
                    <input type="text" id="autoTargetWear" value="0.070000" placeholder="目标磨损"
                        oninput="InputValidator.number(this); AutoMaterialCalculator.recalculate(); IEEE754.updateDisplay('autoTargetWear', 'autoTargetWearIEEEValue', 'autoTargetWearIEEEDisplay')"
                        disabled style="background-color: #f8f9fa;">
                    <div id="autoTargetWearIEEEDisplay" class="ieee754-display">
                        IEEE754: <span id="autoTargetWearIEEEValue" class="ieee754-value"></span>
                    </div>
                </div>
            </div>

            <h3 class="section-title">材料列表</h3>
            <div class="table-container">
                <table class="material-table">
                    <thead>
                        <tr>
                            <th>序号</th>
                            <th>磨损值</th>
                            <th>选择材料</th>
                            <th>磨损区间</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody id="autoMaterialTableBody"></tbody>
                </table>
            </div>
            <div class="action-buttons">
                <button class="danger" onclick="AutoMaterialCalculator.clear()">清空本页所有数据</button>
            </div>
        </div>

        <div id="ieee754Div" class="tabcontent">
            <div class="query-section">
                <h3 class="section-title">🔍 物品查询</h3>
                <div class="selector-container">
                    <h4>搜索物品信息</h4>
                    <div class="material-search-container">
                        <input type="text" id="ieeeSearchInput" class="material-search-input" placeholder="输入物品名称..."
                            oninput="ItemQuery.search(this.value)" onfocus="ItemQuery.showDropdown()"
                            onblur="ItemQuery.hideDropdown()">
                        <div id="ieeeSearchDropdown" class="material-dropdown"></div>
                    </div>
                </div>

                <div id="ieeeResult" class="query-result">
                    <div class="selector-container result-card">
                        <h4 id="resultName" class="result-title"></h4>
                        <div class="result-grid">
                            <div class="result-item">
                                <div class="result-label">磨损区间</div>
                                <div id="resultRange" class="result-value range"></div>
                            </div>
                            <div class="result-item">
                                <div class="result-label">最小磨损</div>
                                <div id="resultMin" class="result-value min"></div>
                            </div>
                            <div class="result-item">
                                <div class="result-label">最大磨损</div>
                                <div id="resultMax" class="result-value max"></div>
                            </div>
                        </div>
                        <div class="sources-container">
                            <div id="resultCollectionsSection" class="source-section">
                                <div class="source-label">📚 收藏品</div>
                                <div id="resultCollections" class="source-content"></div>
                            </div>
                            <div id="resultCratesSection" class="source-section">
                                <div class="source-label">📦 武器箱</div>
                                <div id="resultCrates" class="source-content"></div>
                            </div>
                            <div id="resultOtherSources" class="source-section">
                                <div class="source-label">🔗 其他来源</div>
                                <div id="resultOther" class="source-content"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="divider"></div>

            <div class="conversion-section">
                <h3 class="section-title">🧮 IEEE754 转换</h3>
                <div class="criteria-container">
                    <div class="criteria-item">
                        <h4>目标磨损值</h4>
                        <input id="desiredIEEEInput" placeholder="0.50000" onkeyup="IEEE754.updateRange()">
                    </div>
                    <div class="criteria-item">
                        <h4>IEEE754 表示</h4>
                        <input id="floatIEEEInput" placeholder="0.50000" readonly value="0.50000">
                    </div>
                </div>
                <div class="criteria-container">
                    <div class="criteria-item">
                        <h4>最小边界值</h4>
                        <input id="minIEEEinput" placeholder="0.49999998509883925" readonly value="0.49999998509883925">
                    </div>
                    <div class="criteria-item">
                        <h4>最大边界值</h4>
                        <input id="maxIEEEinput" placeholder="0.500000029802264" readonly value="0.500000029802264">
                    </div>
                    <div class="criteria-item">
                        <h4>中间值</h4>
                        <input id="middleIEEEinput" placeholder="0.5000000074505516" readonly
                            value="0.5000000074505516">
                    </div>
                </div>
            </div>
        </div>

        <div id="aboutAuthorDiv" class="tabcontent">
            <h3 class="section-title">盘尼西林</h3>
            <div class="author-container">
                <div class="author-intro">
                    <h3>盘尼西林</h3>
                    
                    <p>少年，特磨的大门为你敞开，迎接你的0.06666666手套，迎接你的0.008888888宝石刀吧！</p>
                </div>

                <div class="social-grid">
                    <div class="social-card bilibili"
                        onclick="window.open('https://space.bilibili.com/161872957', '_blank')">
                        <div class="social-icon">📺</div>
                        <h4>B站主页</h4>
                        <p>观看我的炼金视频</p>
                        <button class="social-button">访问主页</button>
                    </div>
                    <div class="social-card douyin"
                        onclick="window.open('https://v.douyin.com/mC58bI0Vdmo/ 7@9.com :1pm', '_blank')">
                        <div class="social-icon">🎵</div>
                        <h4>抖音账号</h4>
                        <p>关注我的抖音</p>
                        <button class="social-button">访问账号</button>
                    </div>
                    <div class="social-card buff"
                        onclick="window.open('https://buff.163.com/shop/U1098252483#tab=selling&amp;game=csgo&amp;page_num=1', '_blank')">
                        <div class="social-icon">🛒</div>
                        <h4>BUFF商店</h4>
                        <p>王菲</p>
                        <button class="social-button">访问商店</button>
                    </div>
                    <div class="social-card steam"
                        onclick="window.open('https://steamcommunity.com/id/98801', '_blank')">
                        <div class="social-icon">🎯</div>
                        <h4>Steam主页</h4>
                        <p>添加我为游戏好友</p>
                        <button class="social-button">访问主页</button>
                    </div>
                </div>

                <div class="thank-you-box">
                    <p>感谢你的使用！如果这个工具对你有帮助，欢迎通过以上平台关注我。<br>Q群交流：6800808</p>
                </div>

                <div class="footer-note">
                    <p>感谢每一位使用者，感谢我的粉丝</p>
                </div>
            </div>
        </div>

        <div id="messageToast" class="message-toast"></div>
    </div>

    <script src="script.js"></script>>
    <script src="materials-data.js"></script>
    <script src="crates-data.js"></script>
</body>

</html>